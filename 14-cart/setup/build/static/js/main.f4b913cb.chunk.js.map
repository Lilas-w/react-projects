{"version":3,"sources":["reducer.js","context.js","data.js","Navbar.js","CartItem.js","CartContainer.js","App.js","index.js"],"names":["reducer","state","action","type","cart","filter","cartItem","id","payload","tempCart","map","amount","reduce","cartTotal","price","itemTotal","total","parseFloat","toFixed","loading","Error","AppContext","React","createContext","initialState","title","img","AppProvider","children","useReducer","dispatch","fetchData","a","fetch","response","json","useEffect","Provider","value","clearCart","remove","increase","decrease","toggleAmount","useGlobalContext","useContext","Navbar","className","xmlns","viewBox","d","CartItem","src","alt","onClick","CartContainer","length","item","key","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f4b913cb.chunk.js","sourcesContent":["//2 设置reducer函数\r\nconst reducer = (state, action) => {\r\n    //8 使用if语句改变对应type的状态对象的元素值\r\n    if (action.type === \"CLEAR_CART\") {\r\n        return { ...state, cart: [] };\r\n    }\r\n    //9 \r\n    if (action.type === \"REMOVE\") {\r\n        return { ...state, cart: state.cart.filter((cartItem) => cartItem.id !== action.payload) }\r\n    }\r\n    //10 注意state中amount的增加、减少方法\r\n    if (action.type === \"INCREASE\") {\r\n        let tempCart = state.cart.map((cartItem) => {\r\n            if (cartItem.id === action.payload) {\r\n                return { ...cartItem, amount: cartItem.amount + 1 }\r\n            }\r\n            return cartItem;\r\n        })\r\n        return { ...state, cart: tempCart };\r\n    }\r\n    if (action.type === \"DECREASE\") {\r\n        let tempCart = state.cart\r\n            .map((cartItem) => {\r\n                if (cartItem.id === action.payload) {\r\n                    return { ...cartItem, amount: cartItem.amount - 1 }\r\n                }\r\n                return cartItem;\r\n            })\r\n            .filter((cartItem) => cartItem.amount !== 0)\r\n        return { ...state, cart: tempCart };\r\n    }\r\n\r\n    if (action.type === \"GET_TOTALS\") {\r\n        //reduce() 方法对数组中的每个元素执行一个由您提供的reducer函数(升序执行)，将其结果汇总为单个返回值。\r\n        //const reducer = (accumulator, currentValue) => accumulator + currentValue;\r\n        //array.reduce(function(total, currentValue, currentIndex, arr), initialValue)\r\n        let { total, amount } = state.cart.reduce((cartTotal, cartItem) => {\r\n            const { price, amount } = cartItem;\r\n            const itemTotal = price * amount;\r\n            cartTotal.total += itemTotal;\r\n            cartTotal.amount += amount;\r\n            return cartTotal;\r\n        }, {\r\n            total: 0,\r\n            amount: 0\r\n        })\r\n        //精确到小数点后两位\r\n        total = parseFloat(total.toFixed(2));\r\n\r\n        return { ...state, total, amount }\r\n    }\r\n\r\n    if (action.type === \"LOADING\") {\r\n        return { ...state, loading: true };\r\n    }\r\n    if (action.type === \"DISPLAY_ITEMS\") {\r\n        return { ...state, cart: action.payload, loading: false };\r\n    }\r\n    //13 将10加减函数和为一个函数\r\n    if (action.type === \"TOGGLE_AMOUNT\") {\r\n        let tempCart = state.cart\r\n            .map((cartItem) => {\r\n                if (cartItem.id === action.payload.id) {\r\n                    if (action.payload.type === 'inc') {\r\n                        return { ...cartItem, amount: cartItem.amount + 1 }\r\n                    }\r\n                    if (action.payload.type === 'dec') {\r\n                        return { ...cartItem, amount: cartItem.amount - 1 }\r\n                    }\r\n                }\r\n                return cartItem;\r\n            })\r\n            .filter((cartItem) => cartItem.amount !== 0);\r\n        return { ...state, cart: tempCart }\r\n    }\r\n    throw new Error(\"no matching action type\");\r\n\r\n}\r\n\r\nexport default reducer;","import React, { useState, useContext, useReducer, useEffect } from 'react'\nimport cartItems from './data'\nimport reducer from './reducer'\n// ATTENTION!!!!!!!!!!\n// I SWITCHED TO PERMANENT DOMAIN\nconst url = 'https://course-api.com/react-useReducer-cart-project'\nconst AppContext = React.createContext()\n\nconst initialState = {\n  loading: false,\n  cart: cartItems,\n  total: 0,\n  amount: 0\n}\n\nconst AppProvider = ({ children }) => {\n  //1 useReducer需要初始状态和reducer函数（在reducer组件中定义）\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  //7 设置dispatch的函数，并传入CartContainer组件中，和其UI结构的属性中，并传入AppProvider中，再设置reducer.js中的reducer函数\n  const clearCart = () => {\n    dispatch({ type: \"CLEAR_CART\" });\n  }\n  //9 以下同理7、8，传入CartItem组件\n  //payload是什么？\n  const remove = (id) => {\n    dispatch({ type: \"REMOVE\", payload: id })\n  }\n  //10 以下同理9传入CartItem组件\n  const increase = (id) => {\n    dispatch({ type: \"INCREASE\", payload: id })\n  }\n\n  const decrease = (id) => {\n    dispatch({ type: \"DECREASE\", payload: id })\n  }\n\n  //12 异步获取和展示数据，接着在reducer组件中设置\n  const fetchData = async () => {\n    dispatch({ type: \"LOADING\" });\n    const response = await fetch(url);\n    const cart = await response.json();\n    dispatch({ type: \"DISPLAY_ITEMS\", payload: cart })\n  }\n  useEffect(() => {\n    fetchData();\n  }, [])\n\n  //11 state.cart改变时执行useEffect，设置reducer.js时使用reduce()函数\n  useEffect(() => {\n    dispatch({ type: \"GET_TOTALS\" });\n  }, [state.cart])\n\n  //13 将10加减函数变成一个函数\n  const toggleAmount = (id, type) => {\n    dispatch({ type: \"TOGGLE_AMOUNT\", payload: { id, type } })\n  }\n\n  return (\n    <AppContext.Provider\n      value={{\n        ...state,\n        clearCart,\n        remove,\n        increase,\n        decrease,\n        toggleAmount\n      }}\n    >\n      {children}\n    </AppContext.Provider>\n  )\n}\n// make sure use\nexport const useGlobalContext = () => {\n  return useContext(AppContext)\n}\n\nexport { AppContext, AppProvider }\n","export default [\n  {\n    id: 1,\n    title: 'Samsung Galaxy S7',\n    price: 599.99,\n    img:\n      'https://res.cloudinary.com/diqqf3eq2/image/upload/v1583368215/phone-2_ohtt5s.png',\n    amount: 1,\n  },\n  {\n    id: 2,\n    title: 'google pixel ',\n    price: 499.99,\n    img:\n      'https://res.cloudinary.com/diqqf3eq2/image/upload/v1583371867/phone-1_gvesln.png',\n    amount: 1,\n  },\n  {\n    id: 3,\n    title: 'Xiaomi Redmi Note 2',\n    price: 699.99,\n    img:\n      'https://res.cloudinary.com/diqqf3eq2/image/upload/v1583368224/phone-3_h2s6fo.png',\n    amount: 1,\n  },\n];\n","import React from 'react'\nimport { useGlobalContext } from './context'\nconst Navbar = () => {\n  //4 获取context.js中state的amount\n  const { amount } = useGlobalContext();\n  return (\n    <nav>\n      <div className='nav-center'>\n        <h3>useReducer</h3>\n        <div className='nav-container'>\n          <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'>\n            <path d='M16 6v2h2l2 12H0L2 8h2V6a6 6 0 1 1 12 0zm-2 0a4 4 0 1 0-8 0v2h8V6zM4 10v2h2v-2H4zm10 0v2h2v-2h-2z' />\n          </svg>\n          <div className='amount-container'>\n            <p className='total-amount'>{amount}</p>\n          </div>\n        </div>\n      </div>\n    </nav>\n  )\n}\n\nexport default Navbar\n","import React from 'react'\nimport { useGlobalContext } from './context'\n\nconst CartItem = ({ id, img, title, price, amount }) => {\n  const { remove, increase, decrease, toggleAmount } = useGlobalContext();\n\n  return (\n    <article className='cart-item'>\n      <img src={img} alt={title} />\n      <div>\n        <h4>{title}</h4>\n        <h4 className='item-price'>${price}</h4>\n        {/* remove button */}\n        <button\n          className='remove-btn'\n          onClick={() => remove(id)}\n        >\n          remove\n        </button>\n      </div>\n      <div>\n        {/* increase amount */}\n        <button className='amount-btn' onClick={() => toggleAmount(id, 'inc')}>\n          <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'>\n            <path d='M10.707 7.05L10 6.343 4.343 12l1.414 1.414L10 9.172l4.243 4.242L15.657 12z' />\n          </svg>\n        </button>\n        {/* amount */}\n        <p className='amount'>{amount}</p>\n        {/* decrease amount */}\n        <button className='amount-btn' onClick={() => toggleAmount(id, 'dec')}>\n          <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'>\n            <path d='M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z' />\n          </svg>\n        </button>\n      </div>\n    </article>\n  )\n}\n\nexport default CartItem\n","import React from 'react'\nimport CartItem from './CartItem'\nimport { useGlobalContext } from './context'\n\nconst CartContainer = () => {\n  //3 获取context.js中state的cart和total,并写进UI结构\n  const { cart, total, clearCart } = useGlobalContext()\n  if (cart.length === 0) {\n    return (\n      <section className='cart'>\n        {/* cart header */}\n        <header>\n          <h2>your bag</h2>\n          <h4 className='empty-cart'>is currently empty</h4>\n        </header>\n      </section>\n    )\n  }\n  return (\n    <section className='cart'>\n      {/* cart header */}\n      <header>\n        <h2>your bag</h2>\n      </header>\n      {/* cart items */}\n      <div>\n        {cart.map((item) => {\n          return <CartItem key={item.id} {...item} />\n        })}\n      </div>\n      {/* cart footer */}\n      <footer>\n        <hr />\n        <div className='cart-total'>\n          <h4>\n            total <span>${total}</span>\n          </h4>\n        </div>\n        <button\n          className='btn clear-btn'\n          onClick={clearCart}\n        >\n          clear cart\n        </button>\n      </footer>\n    </section>\n  )\n}\n\nexport default CartContainer\n","import React from 'react'\nimport { useGlobalContext } from './context'\n\n// components\nimport Navbar from './Navbar'\nimport CartContainer from './CartContainer'\n// items\n\nfunction App() {\n  //6 获取context.js中state的loading\n  const { loading } = useGlobalContext();\n\n  if (loading) {\n    return (\n      <div className='loading'>\n        <h1>Loading...</h1>\n      </div>\n    )\n  }\n  return (\n    <main>\n      <Navbar />\n      <CartContainer />\n    </main>\n  )\n}\n\nexport default App\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { AppProvider } from './context';\nReactDOM.render(\n  <React.StrictMode>\n    <AppProvider>\n      <App />\n    </AppProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}